var Collection=function(){var c={dir:"",search:""};var h={dir:"",search:""};var e="";var b="";var f={};var d={items:["#","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]};function a(k,j){var i="collection.php?";i+="d="+unescape(encodeURIComponent(k))+"&";i+="s="+unescape(encodeURIComponent(j));return i}function g(j){var i=Template.processTemplate("collectionTemplate",f[b]);j.html(i);$("body").css("cursor","auto")}return{init:function(){var i=Template.processTemplate("alphaNavTemplate",d);$("#alphaNav").html(i)},goBack:function(){Collection.view({dir:-1})},view:function(j){$("body").css("cursor","wait");var i=$("#output");i.html("Loading...");var l="";var k="";if(j.dir){if(j.dir==-1){l=h.dir}else{l=f[b].d[j.dir].d}k=h.search}else{if(j.search){k=encodeURIComponent(j.search)}}h=c;if(c.search==h.search&&c.dir&&h.dir){h.search=""}c.dir=(l!="")?l.substring(0,l.lastIndexOf("/")):"";c.search=k;e=l?l:k;b=a(l,k);if(f[b]){g(i)}else{Collection.refresh()}},addSong:function(j){var n=f[b].f[j];var k=n.p;var m={file:decodeURIComponent(escape(k))};m.album=n.l;if(n.a){m.artist=n.a}if(n.t){m.title=n.t}else{var i=k.lastIndexOf("/");var o=k.lastIndexOf(".");var l=k.substring(i+1,o);m.title=l}Playlist.addItem(m)},addAll:function(){Playlist.holdRefresh();$(".fileAdd").each(function(j){this.onclick()});Playlist.allowRefresh(true)},refresh:function(){$.ajax({type:"GET",dataType:"json",url:b,success:function(i,j){i.cp=e;f[b]=i;g($("#output"))},error:function(){alert("Unable to retrieve collection.")}})}}}();$(document).ready(function(){Collection.init()});