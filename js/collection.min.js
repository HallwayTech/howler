var Collection=function(){var d=[];var c="";var b={};var a={items:["#","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]};return{addSong:function(f){url=d[d.length-1];var j=b[url].f[f];var g=j.p;var i={file:g};i.album=j.l;if(j.a){i.artist=j.a}if(j.t){i.title=j.t}else{var e=g.lastIndexOf("/");var k=g.lastIndexOf(".");var h=g.substring(e+1,k);i.title=h}Playlist.addItem(i)},addAll:function(){Playlist.holdRefresh();$(".fileAdd").each(function(e){this.onclick()});Playlist.allowRefresh(true)},back:function(){Collection.view(-1)},init:function(){var e=Template.processTemplate("alphaNavTemplate",a);$("#alphaNav").html(e)},renderUrl:function(f){if(!f||b[f]){var g=b[f];var e=Template.processTemplate("collectionTemplate",g);$("#output").html(e);Collection.wait(true)}else{if(f){Collection.update(f)}}},refresh:function(){var e=d[d.length-1];Collection.update(e)},search:function(e){Collection.wait();$("#output").html("Loading...");c=e;url="search.php/"+encodeURIComponent(e);d=[url];Collection.renderUrl(url)},update:function(e){if(e){$.ajax({type:"GET",dataType:"json",url:e,success:function(f,g){f.cp=c;b[e]=f;Collection.renderUrl(e)},error:function(f,h,g){alert("Unable to retrieve collection ["+h+": "+g+"]")}})}},view:function(f){var e="";if(f){Collection.wait();if(f==-1){d.pop();e=d[d.length-1]}else{e=d[d.length-1];c=b[e].d[f].d;e="collection.php/"+encodeURIComponent(c);d.push(e)}}Collection.renderUrl(e)},wait:function(e){if(e){$("body").css("cursor","auto")}else{$("body").css("cursor","wait")}}}}();$(document).ready(function(){Collection.init()});