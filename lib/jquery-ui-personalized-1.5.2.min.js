(function(f){f.ui={plugin:{add:function(i,c,a){var b=f.ui[i].prototype;for(var j in a){b.plugins[j]=b.plugins[j]||[];b.plugins[j].push([c,a[j]])}},call:function(j,c,i){var a=j.plugins[c];if(!a){return}for(var b=0;b<a.length;b++){if(j.options[a[b][0]]){a[b][1].apply(j.element,i)}}}},cssCache:{},css:function(c){if(f.ui.cssCache[c]){return f.ui.cssCache[c]}var b=f('<div class="ui-gen">').addClass(c).css({position:"absolute",top:"-5000px",left:"-5000px",display:"block"}).appendTo("body");f.ui.cssCache[c]=!!((!(/auto|default/).test(b.css("cursor"))||(/^[1-9]/).test(b.css("height"))||(/^[1-9]/).test(b.css("width"))||!(/none/).test(b.css("backgroundImage"))||!(/transparent|rgba\(0, 0, 0, 0\)/).test(b.css("backgroundColor"))));try{f("body").get(0).removeChild(b.get(0))}catch(a){}return f.ui.cssCache[c]},disableSelection:function(a){f(a).attr("unselectable","on").css("MozUserSelect","none")},enableSelection:function(a){f(a).attr("unselectable","off").css("MozUserSelect","")},hasScroll:function(a,c){var i=/top/.test(c||"top")?"scrollTop":"scrollLeft",b=false;if(a[i]>0){return true}a[i]=1;b=a[i]>0?true:false;a[i]=0;return b}};var d=f.fn.remove;f.fn.remove=function(){f("*",this).add(this).triggerHandler("remove");return d.apply(this,arguments)};function e(c,b,a){var h=f[c][b].getter||[];h=(typeof h=="string"?h.split(/,?\s+/):h);return(f.inArray(a,h)!=-1)}f.widget=function(b,c){var a=b.split(".")[0];b=b.split(".")[1];f.fn[b]=function(k){var m=(typeof k=="string"),l=Array.prototype.slice.call(arguments,1);if(m&&e(a,b,k)){var n=f.data(this[0],b);return(n?n[k].apply(n,l):undefined)}return this.each(function(){var g=f.data(this,b);if(m&&g&&f.isFunction(g[k])){g[k].apply(g,l)}else{if(!m){f.data(this,b,new f[a][b](this,k))}}})};f[a][b]=function(j,k){var l=this;this.widgetName=b;this.widgetBaseClass=a+"-"+b;this.options=f.extend({},f.widget.defaults,f[a][b].defaults,k);this.element=f(j).bind("setData."+b,function(g,i,h){return l.setData(i,h)}).bind("getData."+b,function(g,h){return l.getData(h)}).bind("remove",function(){return l.destroy()});this.init()};f[a][b].prototype=f.extend({},f.widget.prototype,c)};f.widget.prototype={init:function(){},destroy:function(){this.element.removeData(this.widgetName)},getData:function(a){return this.options[a]},setData:function(b,a){this.options[b]=a;if(b=="disabled"){this.element[a?"addClass":"removeClass"](this.widgetBaseClass+"-disabled")}},enable:function(){this.setData("disabled",false)},disable:function(){this.setData("disabled",true)}};f.widget.defaults={disabled:false};f.ui.mouse={mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a.mouseDown(b)});if(f.browser.msie){this._mouseUnselectable=this.element.attr("unselectable");this.element.attr("unselectable","on")}this.started=false},mouseDestroy:function(){this.element.unbind("."+this.widgetName);(f.browser.msie&&this.element.attr("unselectable",this._mouseUnselectable))},mouseDown:function(b){(this._mouseStarted&&this.mouseUp(b));this._mouseDownEvent=b;var c=this,a=(b.which==1),i=(typeof this.options.cancel=="string"?f(b.target).parents().add(b.target).filter(this.options.cancel).length:false);if(!a||i||!this.mouseCapture(b)){return true}this._mouseDelayMet=!this.options.delay;if(!this._mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){c._mouseDelayMet=true},this.options.delay)}if(this.mouseDistanceMet(b)&&this.mouseDelayMet(b)){this._mouseStarted=(this.mouseStart(b)!==false);if(!this._mouseStarted){b.preventDefault();return true}}this._mouseMoveDelegate=function(g){return c.mouseMove(g)};this._mouseUpDelegate=function(g){return c.mouseUp(g)};f(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);return false},mouseMove:function(a){if(f.browser.msie&&!a.button){return this.mouseUp(a)}if(this._mouseStarted){this.mouseDrag(a);return false}if(this.mouseDistanceMet(a)&&this.mouseDelayMet(a)){this._mouseStarted=(this.mouseStart(this._mouseDownEvent,a)!==false);(this._mouseStarted?this.mouseDrag(a):this.mouseUp(a))}return !this._mouseStarted},mouseUp:function(a){f(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this.mouseStop(a)}return false},mouseDistanceMet:function(a){return(Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance)},mouseDelayMet:function(a){return this._mouseDelayMet},mouseStart:function(a){},mouseDrag:function(a){},mouseStop:function(a){},mouseCapture:function(a){return true}};f.ui.mouse.defaults={cancel:null,distance:1,delay:0}})(jQuery);(function(b){b.widget("ui.draggable",b.extend({},b.ui.mouse,{init:function(){var a=this.options;if(a.helper=="original"&&!(/(relative|absolute|fixed)/).test(this.element.css("position"))){this.element.css("position","relative")}this.element.addClass("ui-draggable");(a.disabled&&this.element.addClass("ui-draggable-disabled"));this.mouseInit()},mouseStart:function(k){var e=this.options;if(this.helper||e.disabled||b(k.target).is(".ui-resizable-handle")){return false}var n=!this.options.handle||!b(this.options.handle,this.element).length?true:false;b(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==k.target){n=true}});if(!n){return false}if(b.ui.ddmanager){b.ui.ddmanager.current=this}this.helper=b.isFunction(e.helper)?b(e.helper.apply(this.element[0],[k])):(e.helper=="clone"?this.element.clone():this.element);if(!this.helper.parents("body").length){this.helper.appendTo((e.appendTo=="parent"?this.element[0].parentNode:e.appendTo))}if(this.helper[0]!=this.element[0]&&!(/(fixed|absolute)/).test(this.helper.css("position"))){this.helper.css("position","absolute")}this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0)};this.cssPosition=this.helper.css("position");this.offset=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.click={left:k.pageX-this.offset.left,top:k.pageY-this.offset.top};this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();if(this.offsetParent[0]==document.body&&b.browser.mozilla){a={top:0,left:0}}this.offset.parent={top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};var l=this.element.position();this.offset.relative=this.cssPosition=="relative"?{top:l.top-(parseInt(this.helper.css("top"),10)||0)+this.offsetParent[0].scrollTop,left:l.left-(parseInt(this.helper.css("left"),10)||0)+this.offsetParent[0].scrollLeft}:{top:0,left:0};this.originalPosition=this.generatePosition(k);this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};if(e.cursorAt){if(e.cursorAt.left!=undefined){this.offset.click.left=e.cursorAt.left+this.margins.left}if(e.cursorAt.right!=undefined){this.offset.click.left=this.helperProportions.width-e.cursorAt.right+this.margins.left}if(e.cursorAt.top!=undefined){this.offset.click.top=e.cursorAt.top+this.margins.top}if(e.cursorAt.bottom!=undefined){this.offset.click.top=this.helperProportions.height-e.cursorAt.bottom+this.margins.top}}if(e.containment){if(e.containment=="parent"){e.containment=this.helper[0].parentNode}if(e.containment=="document"||e.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b(e.containment=="document"?document:window).width()-this.offset.relative.left-this.offset.parent.left-this.helperProportions.width-this.margins.left-(parseInt(this.element.css("marginRight"),10)||0),(b(e.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.offset.relative.top-this.offset.parent.top-this.helperProportions.height-this.margins.top-(parseInt(this.element.css("marginBottom"),10)||0)]}if(!(/^(document|window|parent)$/).test(e.containment)){var m=b(e.containment)[0];var j=b(e.containment).offset();this.containment=[j.left+(parseInt(b(m).css("borderLeftWidth"),10)||0)-this.offset.relative.left-this.offset.parent.left,j.top+(parseInt(b(m).css("borderTopWidth"),10)||0)-this.offset.relative.top-this.offset.parent.top,j.left+Math.max(m.scrollWidth,m.offsetWidth)-(parseInt(b(m).css("borderLeftWidth"),10)||0)-this.offset.relative.left-this.offset.parent.left-this.helperProportions.width-this.margins.left-(parseInt(this.element.css("marginRight"),10)||0),j.top+Math.max(m.scrollHeight,m.offsetHeight)-(parseInt(b(m).css("borderTopWidth"),10)||0)-this.offset.relative.top-this.offset.parent.top-this.helperProportions.height-this.margins.top-(parseInt(this.element.css("marginBottom"),10)||0)]}}this.propagate("start",k);this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};if(b.ui.ddmanager&&!e.dropBehaviour){b.ui.ddmanager.prepareOffsets(this,k)}this.helper.addClass("ui-draggable-dragging");this.mouseDrag(k);return true},convertPositionTo:function(f,d){if(!d){d=this.position}var a=f=="absolute"?1:-1;return{top:(d.top+this.offset.relative.top*a+this.offset.parent.top*a-(this.cssPosition=="fixed"||(this.cssPosition=="absolute"&&this.offsetParent[0]==document.body)?0:this.offsetParent[0].scrollTop)*a+(this.cssPosition=="fixed"?b(document).scrollTop():0)*a+this.margins.top*a),left:(d.left+this.offset.relative.left*a+this.offset.parent.left*a-(this.cssPosition=="fixed"||(this.cssPosition=="absolute"&&this.offsetParent[0]==document.body)?0:this.offsetParent[0].scrollLeft)*a+(this.cssPosition=="fixed"?b(document).scrollLeft():0)*a+this.margins.left*a)}},generatePosition:function(h){var e=this.options;var a={top:(h.pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"||(this.cssPosition=="absolute"&&this.offsetParent[0]==document.body)?0:this.offsetParent[0].scrollTop)-(this.cssPosition=="fixed"?b(document).scrollTop():0)),left:(h.pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"||(this.cssPosition=="absolute"&&this.offsetParent[0]==document.body)?0:this.offsetParent[0].scrollLeft)-(this.cssPosition=="fixed"?b(document).scrollLeft():0))};if(!this.originalPosition){return a}if(this.containment){if(a.left<this.containment[0]){a.left=this.containment[0]}if(a.top<this.containment[1]){a.top=this.containment[1]}if(a.left>this.containment[2]){a.left=this.containment[2]}if(a.top>this.containment[3]){a.top=this.containment[3]}}if(e.grid){var i=this.originalPosition.top+Math.round((a.top-this.originalPosition.top)/e.grid[1])*e.grid[1];a.top=this.containment?(!(i<this.containment[1]||i>this.containment[3])?i:(!(i<this.containment[1])?i-e.grid[1]:i+e.grid[1])):i;var j=this.originalPosition.left+Math.round((a.left-this.originalPosition.left)/e.grid[0])*e.grid[0];a.left=this.containment?(!(j<this.containment[0]||j>this.containment[2])?j:(!(j<this.containment[0])?j-e.grid[0]:j+e.grid[0])):j}return a},mouseDrag:function(a){this.position=this.generatePosition(a);this.positionAbs=this.convertPositionTo("absolute");this.position=this.propagate("drag",a)||this.position;if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(b.ui.ddmanager){b.ui.ddmanager.drag(this,a)}return false},mouseStop:function(f){var e=false;if(b.ui.ddmanager&&!this.options.dropBehaviour){var e=b.ui.ddmanager.drop(this,f)}if((this.options.revert=="invalid"&&!e)||(this.options.revert=="valid"&&e)||this.options.revert===true){var a=this;b(this.helper).animate(this.originalPosition,parseInt(this.options.revert,10)||500,function(){a.propagate("stop",f);a.clear()})}else{this.propagate("stop",f);this.clear()}return false},clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.options.helper!="original"&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},plugins:{},uiHash:function(a){return{helper:this.helper,position:this.position,absolutePosition:this.positionAbs,options:this.options}},propagate:function(d,a){b.ui.plugin.call(this,d,[a,this.uiHash()]);if(d=="drag"){this.positionAbs=this.convertPositionTo("absolute")}return this.element.triggerHandler(d=="drag"?d:"drag"+d,[a,this.uiHash()],this.options[d])},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable");this.mouseDestroy()}}));b.extend(b.ui.draggable,{defaults:{appendTo:"parent",axis:false,cancel:":input",delay:0,distance:1,helper:"original"}});b.ui.plugin.add("draggable","cursor",{start:function(e,f){var a=b("body");if(a.css("cursor")){f.options._cursor=a.css("cursor")}a.css("cursor",f.options.cursor)},stop:function(d,a){if(a.options._cursor){b("body").css("cursor",a.options._cursor)}}});b.ui.plugin.add("draggable","zIndex",{start:function(e,f){var a=b(f.helper);if(a.css("zIndex")){f.options._zIndex=a.css("zIndex")}a.css("zIndex",f.options.zIndex)},stop:function(d,a){if(a.options._zIndex){b(a.helper).css("zIndex",a.options._zIndex)}}});b.ui.plugin.add("draggable","opacity",{start:function(e,f){var a=b(f.helper);if(a.css("opacity")){f.options._opacity=a.css("opacity")}a.css("opacity",f.options.opacity)},stop:function(d,a){if(a.options._opacity){b(a.helper).css("opacity",a.options._opacity)}}});b.ui.plugin.add("draggable","iframeFix",{start:function(d,a){b(a.options.iframeFix===true?"iframe":a.options.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(b(this).offset()).appendTo("body")})},stop:function(d,a){b("div.DragDropIframeFix").each(function(){this.parentNode.removeChild(this)})}});b.ui.plugin.add("draggable","scroll",{start:function(g,h){var e=h.options;var a=b(this).data("draggable");e.scrollSensitivity=e.scrollSensitivity||20;e.scrollSpeed=e.scrollSpeed||20;a.overflowY=function(c){do{if(/auto|scroll/.test(c.css("overflow"))||(/auto|scroll/).test(c.css("overflow-y"))){return c}c=c.parent()}while(c[0].parentNode);return b(document)}(this);a.overflowX=function(c){do{if(/auto|scroll/.test(c.css("overflow"))||(/auto|scroll/).test(c.css("overflow-x"))){return c}c=c.parent()}while(c[0].parentNode);return b(document)}(this);if(a.overflowY[0]!=document&&a.overflowY[0].tagName!="HTML"){a.overflowYOffset=a.overflowY.offset()}if(a.overflowX[0]!=document&&a.overflowX[0].tagName!="HTML"){a.overflowXOffset=a.overflowX.offset()}},drag:function(g,h){var e=h.options;var a=b(this).data("draggable");if(a.overflowY[0]!=document&&a.overflowY[0].tagName!="HTML"){if((a.overflowYOffset.top+a.overflowY[0].offsetHeight)-g.pageY<e.scrollSensitivity){a.overflowY[0].scrollTop=a.overflowY[0].scrollTop+e.scrollSpeed}if(g.pageY-a.overflowYOffset.top<e.scrollSensitivity){a.overflowY[0].scrollTop=a.overflowY[0].scrollTop-e.scrollSpeed}}else{if(g.pageY-b(document).scrollTop()<e.scrollSensitivity){b(document).scrollTop(b(document).scrollTop()-e.scrollSpeed)}if(b(window).height()-(g.pageY-b(document).scrollTop())<e.scrollSensitivity){b(document).scrollTop(b(document).scrollTop()+e.scrollSpeed)}}if(a.overflowX[0]!=document&&a.overflowX[0].tagName!="HTML"){if((a.overflowXOffset.left+a.overflowX[0].offsetWidth)-g.pageX<e.scrollSensitivity){a.overflowX[0].scrollLeft=a.overflowX[0].scrollLeft+e.scrollSpeed}if(g.pageX-a.overflowXOffset.left<e.scrollSensitivity){a.overflowX[0].scrollLeft=a.overflowX[0].scrollLeft-e.scrollSpeed}}else{if(g.pageX-b(document).scrollLeft()<e.scrollSensitivity){b(document).scrollLeft(b(document).scrollLeft()-e.scrollSpeed)}if(b(window).width()-(g.pageX-b(document).scrollLeft())<e.scrollSensitivity){b(document).scrollLeft(b(document).scrollLeft()+e.scrollSpeed)}}}});b.ui.plugin.add("draggable","snap",{start:function(e,f){var a=b(this).data("draggable");a.snapElements=[];b(f.options.snap===true?".ui-draggable":f.options.snap).each(function(){var c=b(this);var d=c.offset();if(this!=a.element[0]){a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})}})},drag:function(e,H){var i=b(this).data("draggable");var a=H.options.snapTolerance||20;var A=H.absolutePosition.left,B=A+i.helperProportions.width,F=H.absolutePosition.top,G=F+i.helperProportions.height;for(var l=i.snapElements.length-1;l>=0;l--){var z=i.snapElements[l].left,C=z+i.snapElements[l].width,D=i.snapElements[l].top,I=D+i.snapElements[l].height;if(!((z-a<A&&A<C+a&&D-a<F&&F<I+a)||(z-a<A&&A<C+a&&D-a<G&&G<I+a)||(z-a<B&&B<C+a&&D-a<F&&F<I+a)||(z-a<B&&B<C+a&&D-a<G&&G<I+a))){continue}if(H.options.snapMode!="inner"){var d=Math.abs(D-G)<=20;var E=Math.abs(I-F)<=20;var r=Math.abs(z-B)<=20;var t=Math.abs(C-A)<=20;if(d){H.position.top=i.convertPositionTo("relative",{top:D-i.helperProportions.height,left:0}).top}if(E){H.position.top=i.convertPositionTo("relative",{top:I,left:0}).top}if(r){H.position.left=i.convertPositionTo("relative",{top:0,left:z-i.helperProportions.width}).left}if(t){H.position.left=i.convertPositionTo("relative",{top:0,left:C}).left}}if(H.options.snapMode!="outer"){var d=Math.abs(D-F)<=20;var E=Math.abs(I-G)<=20;var r=Math.abs(z-A)<=20;var t=Math.abs(C-B)<=20;if(d){H.position.top=i.convertPositionTo("relative",{top:D,left:0}).top}if(E){H.position.top=i.convertPositionTo("relative",{top:I-i.helperProportions.height,left:0}).top}if(r){H.position.left=i.convertPositionTo("relative",{top:0,left:z}).left}if(t){H.position.left=i.convertPositionTo("relative",{top:0,left:C-i.helperProportions.width}).left}}}}});b.ui.plugin.add("draggable","connectToSortable",{start:function(e,f){var a=b(this).data("draggable");a.sortables=[];b(f.options.connectToSortable).each(function(){if(b.data(this,"sortable")){var c=b.data(this,"sortable");a.sortables.push({instance:c,shouldRevert:c.options.revert});c.refreshItems();c.propagate("activate",e,a)}})},stop:function(e,f){var a=b(this).data("draggable");b.each(a.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;a.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance.mouseStop(e);this.instance.element.triggerHandler("sortreceive",[e,b.extend(this.instance.ui(),{sender:a.element})],this.instance.options.receive);this.instance.options.helper=this.instance.options._helper}else{this.instance.propagate("deactivate",e,a)}})},drag:function(e,h){var i=b(this).data("draggable"),a=this;var j=function(c){var g=c.left,d=g+c.width,f=c.top,l=f+c.height;return(g<(this.positionAbs.left+this.offset.click.left)&&(this.positionAbs.left+this.offset.click.left)<d&&f<(this.positionAbs.top+this.offset.click.top)&&(this.positionAbs.top+this.offset.click.top)<l)};b.each(i.sortables,function(c){if(j.call(i,this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=b(a).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return h.helper[0]};e.target=this.instance.currentItem[0];this.instance.mouseCapture(e,true);this.instance.mouseStart(e,true,true);this.instance.offset.click.top=i.offset.click.top;this.instance.offset.click.left=i.offset.click.left;this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top;i.propagate("toSortable",e)}if(this.instance.currentItem){this.instance.mouseDrag(e)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance.mouseStop(e,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}i.propagate("fromSortable",e)}}})}});b.ui.plugin.add("draggable","stack",{start:function(e,a){var f=b.makeArray(b(a.options.stack.group)).sort(function(c,d){return(parseInt(b(c).css("zIndex"),10)||a.options.stack.min)-(parseInt(b(d).css("zIndex"),10)||a.options.stack.min)});b(f).each(function(c){this.style.zIndex=a.options.stack.min+c});this[0].style.zIndex=a.options.stack.min+f.length}})})(jQuery);(function(c){function d(a,b){var f=c.browser.safari&&c.browser.version<522;if(a.contains&&!f){return a.contains(b)}if(a.compareDocumentPosition){return !!(a.compareDocumentPosition(b)&16)}while(b=b.parentNode){if(b==a){return true}}return false}c.widget("ui.sortable",c.extend({},c.ui.mouse,{init:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?(/left|right/).test(this.items[0].item.css("float")):false;if(!(/(relative|absolute|fixed)/).test(this.element.css("position"))){this.element.css("position","relative")}this.offset=this.element.offset();this.mouseInit()},plugins:{},ui:function(a){return{helper:(a||this)["helper"],placeholder:(a||this)["placeholder"]||c([]),position:(a||this)["position"],absolutePosition:(a||this)["positionAbs"],options:this.options,element:this.element,item:(a||this)["currentItem"],sender:a?a.element:null}},propagate:function(a,b,h,e){c.ui.plugin.call(this,a,[b,this.ui(h)]);if(!e){this.element.triggerHandler(a=="sort"?a:"sort"+a,[b,this.ui(h)],this.options[a])}},serialize:function(a){var f=(c.isFunction(this.options.items)?this.options.items.call(this.element):c(this.options.items,this.element)).not(".ui-sortable-helper");var b=[];a=a||{};f.each(function(){var e=(c(this).attr(a.attribute||"id")||"").match(a.expression||(/(.+)[-=_](.+)/));if(e){b.push((a.key||e[1])+"[]="+(a.key&&a.expression?e[1]:e[2]))}});return b.join("&")},toArray:function(f){var b=(c.isFunction(this.options.items)?this.options.items.call(this.element):c(this.options.items,this.element)).not(".ui-sortable-helper");var a=[];b.each(function(){a.push(c(this).attr(f||"id"))});return a},intersectsWith:function(b){var p=this.positionAbs.left,q=p+this.helperProportions.width,l=this.positionAbs.top,m=l+this.helperProportions.height;var o=b.left,r=o+b.width,a=b.top,n=a+b.height;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance=="guess"&&this.helperProportions[this.floating?"width":"height"]>b[this.floating?"width":"height"])){return(l+this.offset.click.top>a&&l+this.offset.click.top<n&&p+this.offset.click.left>o&&p+this.offset.click.left<r)}else{return(o<p+(this.helperProportions.width/2)&&q-(this.helperProportions.width/2)<r&&a<l+(this.helperProportions.height/2)&&m-(this.helperProportions.height/2)<n)}},intersectsWithEdge:function(b){var p=this.positionAbs.left,q=p+this.helperProportions.width,l=this.positionAbs.top,m=l+this.helperProportions.height;var o=b.left,r=o+b.width,a=b.top,n=a+b.height;if(this.options.tolerance=="pointer"||(this.options.tolerance=="guess"&&this.helperProportions[this.floating?"width":"height"]>b[this.floating?"width":"height"])){if(!(l+this.offset.click.top>a&&l+this.offset.click.top<n&&p+this.offset.click.left>o&&p+this.offset.click.left<r)){return false}if(this.floating){if(p+this.offset.click.left>o&&p+this.offset.click.left<o+b.width/2){return 2}if(p+this.offset.click.left>o+b.width/2&&p+this.offset.click.left<r){return 1}}else{if(l+this.offset.click.top>a&&l+this.offset.click.top<a+b.height/2){return 2}if(l+this.offset.click.top>a+b.height/2&&l+this.offset.click.top<n){return 1}}}else{if(!(o<p+(this.helperProportions.width/2)&&q-(this.helperProportions.width/2)<r&&a<l+(this.helperProportions.height/2)&&m-(this.helperProportions.height/2)<n)){return false}if(this.floating){if(q>o&&p<o){return 2}if(p<r&&q>r){return 1}}else{if(m>a&&l<a){return 1}if(l<n&&m>n){return 2}}}return false},refresh:function(){this.refreshItems();this.refreshPositions()},refreshItems:function(){this.items=[];this.containers=[this];var m=this.items;var n=this;var j=[[c.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):c(this.options.items,this.element),this]];if(this.options.connectWith){for(var i=this.options.connectWith.length-1;i>=0;i--){var a=c(this.options.connectWith[i]);for(var l=a.length-1;l>=0;l--){var b=c.data(a[l],"sortable");if(b&&!b.options.disabled){j.push([c.isFunction(b.options.items)?b.options.items.call(b.element):c(b.options.items,b.element),b]);this.containers.push(b)}}}}for(var i=j.length-1;i>=0;i--){j[i][0].each(function(){c.data(this,"sortable-item",j[i][1]);m.push({item:c(this),instance:j[i][1],width:0,height:0,left:0,top:0})})}},refreshPositions:function(i){if(this.offsetParent){var j=this.offsetParent.offset();this.offset.parent={top:j.top+this.offsetParentBorders.top,left:j.left+this.offsetParentBorders.left}}for(var b=this.items.length-1;b>=0;b--){if(this.items[b].instance!=this.currentContainer&&this.currentContainer&&this.items[b].item[0]!=this.currentItem[0]){continue}var h=this.options.toleranceElement?c(this.options.toleranceElement,this.items[b].item):this.items[b].item;if(!i){this.items[b].width=h[0].offsetWidth;this.items[b].height=h[0].offsetHeight}var a=h.offset();this.items[b].left=a.left;this.items[b].top=a.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var b=this.containers.length-1;b>=0;b--){var a=this.containers[b].element.offset();this.containers[b].containerCache.left=a.left;this.containers[b].containerCache.top=a.top;this.containers[b].containerCache.width=this.containers[b].element.outerWidth();this.containers[b].containerCache.height=this.containers[b].element.outerHeight()}}},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this.mouseDestroy();for(var a=this.items.length-1;a>=0;a--){this.items[a].item.removeData("sortable-item")}},createPlaceholder:function(b){var h=b||this,a=h.options;if(a.placeholder.constructor==String){var g=a.placeholder;a.placeholder={element:function(){return c("<div></div>").addClass(g)[0]},update:function(f,e){e.css(f.offset()).css({width:f.outerWidth(),height:f.outerHeight()})}}}h.placeholder=c(a.placeholder.element.call(h.element,h.currentItem)).appendTo("body").css({position:"absolute"});a.placeholder.update.call(h.element,h.currentItem,h.placeholder)},contactContainers:function(i){for(var m=this.containers.length-1;m>=0;m--){if(this.intersectsWith(this.containers[m].containerCache)){if(!this.containers[m].containerCache.over){if(this.currentContainer!=this.containers[m]){var a=10000;var b=null;var j=this.positionAbs[this.containers[m].floating?"left":"top"];for(var n=this.items.length-1;n>=0;n--){if(!d(this.containers[m].element[0],this.items[n].item[0])){continue}var e=this.items[n][this.containers[m].floating?"left":"top"];if(Math.abs(e-j)<a){a=Math.abs(e-j);b=this.items[n]}}if(!b&&!this.options.dropOnEmpty){continue}if(this.placeholder){this.placeholder.remove()}if(this.containers[m].options.placeholder){this.containers[m].createPlaceholder(this)}else{this.placeholder=null}this.currentContainer=this.containers[m];b?this.rearrange(i,b,null,true):this.rearrange(i,null,this.containers[m].element,true);this.propagate("change",i);this.containers[m].propagate("change",i,this)}this.containers[m].propagate("over",i,this);this.containers[m].containerCache.over=1}}else{if(this.containers[m].containerCache.over){this.containers[m].propagate("out",i,this);this.containers[m].containerCache.over=0}}}},mouseCapture:function(b,e){if(this.options.disabled||this.options.type=="static"){return false}this.refreshItems();var j=null,k=this,l=c(b.target).parents().each(function(){if(c.data(this,"sortable-item")==k){j=c(this);return false}});if(c.data(b.target,"sortable-item")==k){j=c(b.target)}if(!j){return false}if(this.options.handle&&!e){var a=false;c(this.options.handle,j).find("*").andSelf().each(function(){if(this==b.target){a=true}});if(!a){return false}}this.currentItem=j;return true},mouseStart:function(e,m,p){var a=this.options;this.currentContainer=this;this.refreshPositions();this.helper=typeof a.helper=="function"?c(a.helper.apply(this.element[0],[e,this.currentItem])):this.currentItem.clone();if(!this.helper.parents("body").length){c(a.appendTo!="parent"?a.appendTo:this.currentItem[0].parentNode)[0].appendChild(this.helper[0])}this.helper.css({position:"absolute",clear:"both"}).addClass("ui-sortable-helper");this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top};this.offsetParent=this.helper.offsetParent();var o=this.offsetParent.offset();this.offsetParentBorders={top:(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};this.offset.parent={top:o.top+this.offsetParentBorders.top,left:o.left+this.offsetParentBorders.left};this.originalPosition=this.generatePosition(e);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};if(a.placeholder){this.createPlaceholder()}this.propagate("start",e);this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};if(a.cursorAt){if(a.cursorAt.left!=undefined){this.offset.click.left=a.cursorAt.left}if(a.cursorAt.right!=undefined){this.offset.click.left=this.helperProportions.width-a.cursorAt.right}if(a.cursorAt.top!=undefined){this.offset.click.top=a.cursorAt.top}if(a.cursorAt.bottom!=undefined){this.offset.click.top=this.helperProportions.height-a.cursorAt.bottom}}if(a.containment){if(a.containment=="parent"){a.containment=this.helper[0].parentNode}if(a.containment=="document"||a.containment=="window"){this.containment=[0-this.offset.parent.left,0-this.offset.parent.top,c(a.containment=="document"?document:window).width()-this.offset.parent.left-this.helperProportions.width-this.margins.left-(parseInt(this.element.css("marginRight"),10)||0),(c(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.offset.parent.top-this.helperProportions.height-this.margins.top-(parseInt(this.element.css("marginBottom"),10)||0)]}if(!(/^(document|window|parent)$/).test(a.containment)){var i=c(a.containment)[0];var b=c(a.containment).offset();this.containment=[b.left+(parseInt(c(i).css("borderLeftWidth"),10)||0)-this.offset.parent.left,b.top+(parseInt(c(i).css("borderTopWidth"),10)||0)-this.offset.parent.top,b.left+Math.max(i.scrollWidth,i.offsetWidth)-(parseInt(c(i).css("borderLeftWidth"),10)||0)-this.offset.parent.left-this.helperProportions.width-this.margins.left-(parseInt(this.currentItem.css("marginRight"),10)||0),b.top+Math.max(i.scrollHeight,i.offsetHeight)-(parseInt(c(i).css("borderTopWidth"),10)||0)-this.offset.parent.top-this.helperProportions.height-this.margins.top-(parseInt(this.currentItem.css("marginBottom"),10)||0)]}}if(this.options.placeholder!="clone"){this.currentItem.css("visibility","hidden")}if(!p){for(var n=this.containers.length-1;n>=0;n--){this.containers[n].propagate("activate",e,this)}}if(c.ui.ddmanager){c.ui.ddmanager.current=this}if(c.ui.ddmanager&&!a.dropBehaviour){c.ui.ddmanager.prepareOffsets(this,e)}this.dragging=true;this.mouseDrag(e);return true},convertPositionTo:function(b,a){if(!a){a=this.position}var g=b=="absolute"?1:-1;return{top:(a.top+this.offset.parent.top*g-(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)*g+this.margins.top*g),left:(a.left+this.offset.parent.left*g-(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft)*g+this.margins.left*g)}},generatePosition:function(b){var a=this.options;var j={top:(b.pageY-this.offset.click.top-this.offset.parent.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)),left:(b.pageX-this.offset.click.left-this.offset.parent.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft))};if(!this.originalPosition){return j}if(this.containment){if(j.left<this.containment[0]){j.left=this.containment[0]}if(j.top<this.containment[1]){j.top=this.containment[1]}if(j.left>this.containment[2]){j.left=this.containment[2]}if(j.top>this.containment[3]){j.top=this.containment[3]}}if(a.grid){var e=this.originalPosition.top+Math.round((j.top-this.originalPosition.top)/a.grid[1])*a.grid[1];j.top=this.containment?(!(e<this.containment[1]||e>this.containment[3])?e:(!(e<this.containment[1])?e-a.grid[1]:e+a.grid[1])):e;var i=this.originalPosition.left+Math.round((j.left-this.originalPosition.left)/a.grid[0])*a.grid[0];j.left=this.containment?(!(i<this.containment[0]||i>this.containment[2])?i:(!(i<this.containment[0])?i-a.grid[0]:i+a.grid[0])):i}return j},mouseDrag:function(b){this.position=this.generatePosition(b);this.positionAbs=this.convertPositionTo("absolute");c.ui.plugin.call(this,"sort",[b,this.ui()]);this.positionAbs=this.convertPositionTo("absolute");this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";for(var e=this.items.length-1;e>=0;e--){var a=this.intersectsWithEdge(this.items[e]);if(!a){continue}if(this.items[e].item[0]!=this.currentItem[0]&&this.currentItem[a==1?"next":"prev"]()[0]!=this.items[e].item[0]&&!d(this.currentItem[0],this.items[e].item[0])&&(this.options.type=="semi-dynamic"?!d(this.element[0],this.items[e].item[0]):true)){this.direction=a==1?"down":"up";this.rearrange(b,this.items[e]);this.propagate("change",b);break}}this.contactContainers(b);if(c.ui.ddmanager){c.ui.ddmanager.drag(this,b)}this.element.triggerHandler("sort",[b,this.ui()],this.options.sort);return false},rearrange:function(a,b,k,e){k?k[0].appendChild(this.currentItem[0]):b.item[0].parentNode.insertBefore(this.currentItem[0],(this.direction=="down"?b.item[0]:b.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var i=this,l=this.counter;window.setTimeout(function(){if(l==i.counter){i.refreshPositions(!e)}},0);if(this.options.placeholder){this.options.placeholder.update.call(this.element,this.currentItem,this.placeholder)}},mouseStop:function(b,e){if(c.ui.ddmanager&&!this.options.dropBehaviour){c.ui.ddmanager.drop(this,b)}if(this.options.revert){var h=this;var a=h.currentItem.offset();if(h.placeholder){h.placeholder.animate({opacity:"hide"},(parseInt(this.options.revert,10)||500)-50)}c(this.helper).animate({left:a.left-this.offset.parent.left-h.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:a.top-this.offset.parent.top-h.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){h.clear(b)})}else{this.clear(b,e)}return false},clear:function(a,b){if(this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0]){this.propagate("update",a,null,b)}if(!d(this.element[0],this.currentItem[0])){this.propagate("remove",a,null,b);for(var e=this.containers.length-1;e>=0;e--){if(d(this.containers[e].element[0],this.currentItem[0])){this.containers[e].propagate("update",a,this,b);this.containers[e].propagate("receive",a,this,b)}}}for(var e=this.containers.length-1;e>=0;e--){this.containers[e].propagate("deactivate",a,this,b);if(this.containers[e].containerCache.over){this.containers[e].propagate("out",a,this);this.containers[e].containerCache.over=0}}this.dragging=false;if(this.cancelHelperRemoval){this.propagate("stop",a,null,b);return false}c(this.currentItem).css("visibility","");if(this.placeholder){this.placeholder.remove()}this.helper.remove();this.helper=null;this.propagate("stop",a,null,b);return true}}));c.extend(c.ui.sortable,{getter:"serialize toArray",defaults:{helper:"clone",tolerance:"guess",distance:1,delay:0,scroll:true,scrollSensitivity:20,scrollSpeed:20,cancel:":input",items:"> *",zIndex:1000,dropOnEmpty:true,appendTo:"parent"}});c.ui.plugin.add("sortable","cursor",{start:function(a,b){var e=c("body");if(e.css("cursor")){b.options._cursor=e.css("cursor")}e.css("cursor",b.options.cursor)},stop:function(a,b){if(b.options._cursor){c("body").css("cursor",b.options._cursor)}}});c.ui.plugin.add("sortable","zIndex",{start:function(a,b){var e=b.helper;if(e.css("zIndex")){b.options._zIndex=e.css("zIndex")}e.css("zIndex",b.options.zIndex)},stop:function(a,b){if(b.options._zIndex){c(b.helper).css("zIndex",b.options._zIndex)}}});c.ui.plugin.add("sortable","opacity",{start:function(a,b){var e=b.helper;if(e.css("opacity")){b.options._opacity=e.css("opacity")}e.css("opacity",b.options.opacity)},stop:function(a,b){if(b.options._opacity){c(b.helper).css("opacity",b.options._opacity)}}});c.ui.plugin.add("sortable","scroll",{start:function(b,e){var a=e.options;var h=c(this).data("sortable");h.overflowY=function(f){do{if(/auto|scroll/.test(f.css("overflow"))||(/auto|scroll/).test(f.css("overflow-y"))){return f}f=f.parent()}while(f[0].parentNode);return c(document)}(h.currentItem);h.overflowX=function(f){do{if(/auto|scroll/.test(f.css("overflow"))||(/auto|scroll/).test(f.css("overflow-x"))){return f}f=f.parent()}while(f[0].parentNode);return c(document)}(h.currentItem);if(h.overflowY[0]!=document&&h.overflowY[0].tagName!="HTML"){h.overflowYOffset=h.overflowY.offset()}if(h.overflowX[0]!=document&&h.overflowX[0].tagName!="HTML"){h.overflowXOffset=h.overflowX.offset()}},sort:function(b,e){var a=e.options;var h=c(this).data("sortable");if(h.overflowY[0]!=document&&h.overflowY[0].tagName!="HTML"){if((h.overflowYOffset.top+h.overflowY[0].offsetHeight)-b.pageY<a.scrollSensitivity){h.overflowY[0].scrollTop=h.overflowY[0].scrollTop+a.scrollSpeed}if(b.pageY-h.overflowYOffset.top<a.scrollSensitivity){h.overflowY[0].scrollTop=h.overflowY[0].scrollTop-a.scrollSpeed}}else{if(b.pageY-c(document).scrollTop()<a.scrollSensitivity){c(document).scrollTop(c(document).scrollTop()-a.scrollSpeed)}if(c(window).height()-(b.pageY-c(document).scrollTop())<a.scrollSensitivity){c(document).scrollTop(c(document).scrollTop()+a.scrollSpeed)}}if(h.overflowX[0]!=document&&h.overflowX[0].tagName!="HTML"){if((h.overflowXOffset.left+h.overflowX[0].offsetWidth)-b.pageX<a.scrollSensitivity){h.overflowX[0].scrollLeft=h.overflowX[0].scrollLeft+a.scrollSpeed}if(b.pageX-h.overflowXOffset.left<a.scrollSensitivity){h.overflowX[0].scrollLeft=h.overflowX[0].scrollLeft-a.scrollSpeed}}else{if(b.pageX-c(document).scrollLeft()<a.scrollSensitivity){c(document).scrollLeft(c(document).scrollLeft()-a.scrollSpeed)}if(c(window).width()-(b.pageX-c(document).scrollLeft())<a.scrollSensitivity){c(document).scrollLeft(c(document).scrollLeft()+a.scrollSpeed)}}}});c.ui.plugin.add("sortable","axis",{sort:function(a,b){var e=c(this).data("sortable");if(b.options.axis=="y"){e.position.left=e.originalPosition.left}if(b.options.axis=="x"){e.position.top=e.originalPosition.top}}})})(jQuery);